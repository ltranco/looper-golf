{% extends "layout.html" %}
{% block content %}


<div class="events-detail-view">
    <h1>{{ event_name }}{% if event_private %}<span class="private-event">(private event)</span>{% endif %}</h1>
    <h4>{{ event_loc }}</h4>
    <h6>{{ event_date }}</h6>
    <p>{{ event_desc }}</p>

    <div class="text-center">
        {% if not org_status and not event_private%}
            {% if unregister %}
                <a class="btn btn-primary red-button" href="/clubs/{{org_id}}/events/{{event_id}}/unregister">Unregister</a>
            {% else %}
                <a class="btn btn-primary" href="/clubs/{{org_id}}/events/{{event_id}}/register">Register</a>
            {% endif %}
        {% endif %}
        <a class="btn btn-default" href="/clubs/{{org_id}}">All Events</a>
        <a class="btn btn-default" href="/">Home</a>
    </div>

    {% if participants and org_status %}
        <p>{{ participants|length }} person(s) registered for this event:</p>
        <ul class="player-list" id="sortable">
            {% for p in participants %}
                <li class="sortedPlayer">{{ p.username }}</li>
            {% endfor %}
        </ul>
        <div class="text-center">
            <a id="sortedPlayersList" class="btn btn-primary">Save Current Order</a>
        </div>
    {% endif %}

</div>
<script>
    $(function() {
        $("#sortable").sortable();
        $("#sortable").disableSelection();
        $("#sortedPlayersList").click(function() {
            var playersObject = $(".sortedPlayer");
            var players = [];
            for(var i = 0; i < playersObject.length; i++) {
                players.push(playersObject[i].innerText);
            }
            window.location.href="rearrange?p=" + players.join();
        });
    });
</script>
{% endblock %}